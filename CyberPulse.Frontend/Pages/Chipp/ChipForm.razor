@if (loading)
{
	<Loading />
}
else
{
	<NavigationLock OnBeforeInternalNavigation="OnBeforeInternalNavigation" />
	<EditForm EditContext="editContext" OnValidSubmit="OnValidSubmit">
		<DataAnnotationsValidator />


		<MudGrid>
			<MudItem xs="12" sm="6">
				<MudAutocomplete T="ChipProgramDTO"
								 Label=@Localizer["ChipProgram"]
								 SearchFunc="SearchChipProgram"
								 Placeholder=@Localizer["SelectAChipProgram"]
								 AdornmentIcon="@Icons.Material.Filled.Search"
								 AdornmentColor="Color.Primary"
								 Value="selectedChipProgram"
								 ValueChanged="ChipProgramChanged"
								 Disabled="@desabledCompany"
								 ToStringFunc="@(e=> e==null?null : $"{e.Code} {e.Designation}")"
								 For="@(()=>chipDTO.ChipProgram)">
					<ItemTemplate Context="itemContext">
						@itemContext.Code @itemContext.Designation
					</ItemTemplate>

				</MudAutocomplete>


				<MudGrid Style="margin-top: 1px;">
					<MudItem xs="12" sm="3">
						<MudTextField Label="@Localizer["ChipNo"]"
									  @bind-Value="@chipDTO.ChipNo"
									  Disabled="@desabledCompany"
									  For="@(() => chipDTO.ChipNo)" />

					</MudItem>
					<MudItem xs="12" sm="3">
						<MudTextField Label="@Localizer["Duration"]"
									  @bind-Value="@chipDTO.Duration"
									  ReadOnly="true"
									  For="@(() => chipDTO.Duration)" />

					</MudItem>
					<MudItem xs="12" sm="3">
						<MudCheckBox T="bool"
									 LabelPosition="Start" 
									 Style="font-size: small;"
									 Label="@Localizer["Holiday"]"
									 @bind-value="@chipDTO.Holiday"									 
										Color="Color.Primary"
									 onblur="@(() => ValidateOnBlur())" />

					</MudItem>
					<MudItem xs="12" sm="3">
						<MudNumericField Label="@Localizer["Apprentices"]"
										 @bind-Value="@chipDTO.Apprentices"
										 Min=0
										 For="@(() => chipDTO.Apprentices)" />

					</MudItem>
				</MudGrid>

				<MudItem xs="12">
					<MudAutocomplete T="ChipUserDTO"
									 Label=@Localizer["Instructor"]
									 Placeholder=@Localizer["SelectAInstructor"]
									 SearchFunc="SearchInstructor"
									 Value="selectedInstructor"
									 ValueChanged="InstructorChanged"
									 ToStringFunc="@(e=> e==null?null : $"{e.FirstName} {e.LastName}")"
									 AdornmentIcon="@Icons.Material.Filled.People"
									 Disabled="@desabledCompany"
									 Adornment="Adornment.End"
									 For="@(()=>chipDTO.Instructor)">
						<ItemTemplate Context="itemContext">
							@itemContext.DocumentId @itemContext.FirstName @itemContext.LastName
						</ItemTemplate>
					</MudAutocomplete>

				</MudItem>

				<MudGrid>
					<MudItem xs="12" sm="6">
						<MudAutocomplete T="CityDTO"
										 Label=@Localizer["City"]
										 Placeholder=@Localizer["SelectACity"]
										 SearchFunc="SearchCity"
										 Value="selectedCity"
										 ValueChanged="CityChanged"
										 ToStringFunc="@(e=> e==null?null : $"{e.Name}")"
										 For="@(()=>chipDTO.City)">
							<ItemTemplate Context="itemContext">
								@itemContext.Name
							</ItemTemplate>
						</MudAutocomplete>
					</MudItem>
					<MudItem xs="12" sm="6">
						<MudAutocomplete T="Neighborhood"
										 Label=@Localizer["Neighborhood"]
										 Placeholder=@Localizer["SelectANeighborhood"]
										 SearchFunc="SearchNeighborhood"
										 Value="selectedNeighborhood"
										 ValueChanged="NeighborhoodChanged"
										 ToStringFunc="@(e=> e==null?null : $"{e.Name}")">
							<ItemTemplate Context="itemContext">
								@itemContext.Name
							</ItemTemplate>
						</MudAutocomplete>
					</MudItem>
				</MudGrid>


				<MudItem xs="12">
					<MudAutocomplete T="TrainingProgramDTO"
									 Label=@Localizer["TrainingProgram"]
									 Placeholder=@Localizer["SelectATrainingProgram"]
									 SearchFunc="SearchTrainingProgram"
									 Value="selectedTrainingProgram"
									 ValueChanged="TrainingProgramChanged"
									 ToStringFunc="@(e=> e==null?null : $"{e.Name}")"
									 For="@(()=>chipDTO.TrainingProgram)">
						<ItemTemplate Context="itemContext">
							@itemContext.Name
						</ItemTemplate>
					</MudAutocomplete>
				</MudItem>
				<MudGrid>
					<MudItem xs="12" sm="6">
						<MudAutocomplete T="TypeOfTrainingDTO"
										 Label=@Localizer["TypeOfTraining"]
										 Placeholder=@Localizer["SelectATypeOfTraining"]
										 SearchFunc="SearchTypeOfTraining"
										 Value="selectedTypeOfTraining"
										 ValueChanged="TypeOfTrainingChanged"
										 ToStringFunc="@(e=> e==null?null : $"{e.Name}")"
										 For="@(()=>chipDTO.TypeOfTraining)">
							<ItemTemplate Context="itemContext">
								@itemContext.Name
							</ItemTemplate>
						</MudAutocomplete>
					</MudItem>
					<MudItem xs="12" sm="6">
						<MudTextField Label="@Localizer["Company"]"
									  @bind-Value="@chipDTO.Company"
									  Adornment="Adornment.End"
									  AdornmentIcon="@Icons.Material.Filled.BusinessCenter"
									  For="@(() => chipDTO.Company)"
									  class="mb-3" />
					</MudItem>
				</MudGrid>

				<MudItem xs="12">
					<MudTextField Label="@Localizer["Justification"]"
								  @bind-Value="@chipDTO.Justification"
								  For="@(() => chipDTO.Justification)"
								  class="mb-3" />
				</MudItem>

				<MudGrid>
					<MudItem xs="12" sm="4">
						<MudTextField Label="@Localizer["StartDate"]"
									  @bind-Value="@chipDTO.StartDate"
									  For="@(() => chipDTO.StartDate)"
									  Adornment="Adornment.End"
									  AdornmentIcon="@Icons.Material.Filled.CalendarToday"
									  ReadOnly=true
									  class="mb-3" />
					</MudItem>
					<MudItem xs="12" sm="4">
						<MudTextField Label="@Localizer["EndDate"]"
									  @bind-Value="@chipDTO.EndDate"
									  For="@(() => chipDTO.EndDate)"
									  Adornment="Adornment.End"
									  AdornmentIcon="@Icons.Material.Filled.CalendarToday"
									  ReadOnly=true
									  class="mb-3" />
					</MudItem>
					<MudItem xs="12" sm="4">
						<MudTextField Label="@Localizer["AlertDate"]"
									  @bind-Value="@chipDTO.AlertDate"
									  For="@(() => chipDTO.AlertDate)"
									  Adornment="Adornment.End"
									  AdornmentIcon="@Icons.Material.Filled.CalendarToday"
									  ReadOnly=true
									  class="mb-3" />
					</MudItem>
				</MudGrid>
			</MudItem>
			<MudItem xs="12" sm="6">
				<MudItem xs="12">
					<MudGrid>
						<MudItem xs="12" sm="2"><MudText Typo="Typo.subtitle2">Horario</MudText></MudItem>
						<MudItem xs="12" sm="4"><MudText Typo="Typo.subtitle2">Mañana</MudText></MudItem>
						<MudItem xs="12" sm="4"><MudText Typo="Typo.subtitle2">Tarde</MudText></MudItem>
					</MudGrid>
				</MudItem>
				<MudItem xs="12" Style="height:170px;overflow-y:scroll;margin-top: 10px;">

					<MudItem xs="12" Style="margin-top: 10px;"><MudText Typo="Typo.subtitle2">@Localizer["Monday"]</MudText></MudItem>
					<MudGrid>
						<MudItem xs="12" sm="3">
							@* 							<MudTextField T="string"
										  Label="Time"
										  InputType="InputType.Time"
										  Format="HH:mm"
										  Min="12:00"
										  Max="23:59"
										  @bind-Value="@timeValue"
										  Validation="@(()=>ValidateTime)" />
 *@
							<MudTextField Label="@Localizer["DateStart"]"
										  Mask="@(new PatternMask("00:00"))"
										  @bind-Value="@chipDTO.MondayMorningStart"
										  AdornmentIcon="@Icons.Material.Filled.HourglassFull"
										  For="@(() => chipDTO.MondayMorningStart)"
										  onblur="@(() => ValidateOnBlur())" />

						</MudItem>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateEnd"]"
										  Mask="@(new PatternMask("00:00"))"
										  @bind-Value="@chipDTO.MondayMorningEnd"
										  For="@(() => chipDTO.MondayMorningEnd)"
										  onblur="@(() => ValidateOnBlur())" />
						</MudItem>

						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateStart"]"
										  Mask="@(new PatternMask("00:00"))"
										  @bind-Value="@chipDTO.MondayAfternoonStart"
										  For="@(() => chipDTO.MondayAfternoonStart)"
										  onblur="@(() => ValidateOnBlur())" />
						</MudItem>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateEnd"]"
										  Mask="@(new PatternMask("00:00"))"
										  @bind-Value="@chipDTO.MondayAfternoonEnd"
										  For="@(() => chipDTO.MondayAfternoonEnd)"
										  onblur="@(() => ValidateOnBlur())" />
						</MudItem>
					</MudGrid>

					<MudItem xs="12" Style="margin-top: 10px;"><MudText Typo="Typo.subtitle2">@Localizer["Tuesday"]</MudText></MudItem>
					<MudGrid>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateStart"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.TuesdayMorningStart"
										  For="@(() => chipDTO.TuesdayMorningStart)"
										  onblur="@(() => ValidateOnBlur())" />

						</MudItem>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateEnd"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.TuesdayMorningEnd"
										  For="@(() => chipDTO.TuesdayMorningEnd)"
										  onblur="@(() => ValidateOnBlur())" />
						</MudItem>

						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateStart"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.TuesdayAfternoonStart"
										  For="@(() => chipDTO.TuesdayAfternoonStart)"
										  onblur="@(() => ValidateOnBlur())" />
						</MudItem>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateEnd"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.TuesdayAfternoonEnd"
										  For="@(() => chipDTO.TuesdayAfternoonEnd)"
										  onblur="@(() => ValidateOnBlur())" />

						</MudItem>
					</MudGrid>

					<MudItem xs="12" Style="margin-top: 10px;"><MudText Typo="Typo.subtitle2">@Localizer["Wednesday"]</MudText></MudItem>
					<MudGrid>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateStart"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.WednesdayMorningStart"
										  For="@(() => chipDTO.WednesdayMorningStart)"
										  onblur="@(() => ValidateOnBlur())" />

						</MudItem>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateEnd"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.WednesdayMorningEnd"
										  For="@(() => chipDTO.WednesdayMorningEnd)"
										  onblur="@(() => ValidateOnBlur())" />
						</MudItem>

						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateStart"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.WednesdayAfternoonStart"
										  For="@(() => chipDTO.WednesdayAfternoonStart)"
										  onblur="@(() => ValidateOnBlur())" />
						</MudItem>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateEnd"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.WednesdayAfternoonEnd"
										  For="@(() => chipDTO.WednesdayAfternoonEnd)"
										  onblur="@(() => ValidateOnBlur())" />

						</MudItem>
					</MudGrid>

					<MudItem xs="12" Style="margin-top: 10px;"><MudText Typo="Typo.subtitle2">@Localizer["Tursday"]</MudText></MudItem>
					<MudGrid>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateStart"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.ThursdayMorningStart"
										  For="@(() => chipDTO.ThursdayMorningStart)"
										  onblur="@(() => ValidateOnBlur())" />

						</MudItem>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateEnd"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.ThursdayMorningEnd"
										  For="@(() => chipDTO.ThursdayMorningEnd)"
										  onblur="@(() => ValidateOnBlur())" />
						</MudItem>

						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateStart"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.ThursdayAfternoonStart"
										  For="@(() => chipDTO.ThursdayAfternoonStart)"
										  onblur="@(() => ValidateOnBlur())" />
						</MudItem>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateEnd"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.ThursdayAfternoonEnd"
										  For="@(() => chipDTO.ThursdayAfternoonEnd)"
										  onblur="@(() => ValidateOnBlur())" />

						</MudItem>
					</MudGrid>

					<MudItem xs="12" Style="margin-top: 10px;"><MudText Typo="Typo.subtitle2">@Localizer["Friday"]</MudText></MudItem>
					<MudGrid>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateStart"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.FridayMorningStart"
										  For="@(() => chipDTO.FridayMorningStart)"
										  onblur="@(() => ValidateOnBlur())" />

						</MudItem>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateEnd"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.FridayMorningEnd"
										  For="@(() => chipDTO.FridayMorningEnd)"
										  onblur="@(() => ValidateOnBlur())" />
						</MudItem>

						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateStart"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.FridayAfternoonStart"
										  For="@(() => chipDTO.FridayAfternoonStart)"
										  onblur="@(() => ValidateOnBlur())" />
						</MudItem>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateEnd"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.FridayAfternoonEnd"
										  For="@(() => chipDTO.FridayAfternoonEnd)"
										  onblur="@(() => ValidateOnBlur())" />

						</MudItem>
					</MudGrid>

					<MudItem xs="12" Style="margin-top: 10px;"><MudText Typo="Typo.subtitle2">@Localizer["Saturday"]</MudText></MudItem>
					<MudGrid>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateStart"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.SaturdayMorningStart"
										  For="@(() => chipDTO.SaturdayMorningStart)"
										  onblur="@(() => ValidateOnBlur())" />

						</MudItem>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateEnd"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.SaturdayMorningEnd"
										  For="@(() => chipDTO.SaturdayMorningEnd)"
										  onblur="@(() => ValidateOnBlur())" />
						</MudItem>

						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateStart"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.SaturdayAfternoonStart"
										  For="@(() => chipDTO.SaturdayAfternoonStart)"
										  onblur="@(() => ValidateOnBlur())" />
						</MudItem>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateEnd"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.SaturdayAfternoonEnd"
										  For="@(() => chipDTO.SaturdayAfternoonEnd)"
										  onblur="@(() => ValidateOnBlur())" />

						</MudItem>
					</MudGrid>

					<MudItem xs="12" Style="margin-top: 10px;"><MudText Typo="Typo.subtitle2">@Localizer["Sunday"]</MudText></MudItem>
					<MudGrid>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateStart"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.SundayMorningStart"
										  For="@(() => chipDTO.SundayMorningStart)"
										  onblur="@(() => ValidateOnBlur())" />

						</MudItem>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateEnd"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.SundayMorningEnd"
										  For="@(() => chipDTO.SundayMorningEnd)"
										  onblur="@(() => ValidateOnBlur())" />
						</MudItem>

						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateStart"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.SundayAfternoonStart"
										  For="@(() => chipDTO.SundayAfternoonStart)"
										  onblur="@(() => ValidateOnBlur())" />
						</MudItem>
						<MudItem xs="12" sm="3">
							<MudTextField Label="@Localizer["DateEnd"]"
										  Mask="@mask1"
										  @bind-Value="@chipDTO.SundayAfternoonEnd"
										  For="@(() => chipDTO.SundayAfternoonEnd)"
										  onblur="@(() => ValidateOnBlur())" />

						</MudItem>
					</MudGrid>

				</MudItem>

				<MudDivider Class="my-2" DividerType="DividerType.Inset" />

				<MudItem xs="12" Style="margin-top: 10px;"><MudText Typo="Typo.subtitle2">Tipe de población al cual pertenece</MudText></MudItem>

				<MudItem xs="12" Style="height:170px;overflow-y:scroll;font-size:80%">

					<MudTable Items="@chipDTO.TypeOfPoblationDTO" Hover="true">
						<HeaderContent>
							<MudTh>Id</MudTh>
							<MudTh>Nombre</MudTh>
							<MudTh Class="text-center">Cant</MudTh>
						</HeaderContent>
						<RowTemplate Context="item">
							<MudTd DataLabel="Id">@item.Id</MudTd>
							<MudTd DataLabel="Nombre">@item.Name</MudTd>
							<MudTd DataLabel="Cant">

								<MudTextField Class="text-center"
											  MaxLength="2"
											  @bind-Value="@item.Quantity"
											  Variant="@Variant.Text" />
							</MudTd>
						</RowTemplate>
					</MudTable>
				</MudItem>
			</MudItem>
		</MudGrid>

		<MudDivider Class="mb-lg-3 mt-lh-3" DividerType="DividerType.Inset" />
		<MudButton Variant="Variant.Outlined"
				   StartIcon="@Icons.Material.Filled.ArrowBack"
				   Color="Color.Info"
				   OnClick="ReturnAction">
			@Localizer["Return"]
		</MudButton>

		<MudButton Variant="Variant.Outlined"
				   StartIcon="@Icons.Material.Filled.Check"
				   Color="Color.Primary"
				   ButtonType="ButtonType.Submit">
			@Localizer["SaveChanges"]
		</MudButton>
	</EditForm>
}