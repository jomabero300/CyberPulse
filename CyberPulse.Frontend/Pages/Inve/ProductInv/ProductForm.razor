<NavigationLock OnBeforeInternalNavigation="OnBeforeInternalNavigation" />

<EditForm EditContext="editContext" OnValidSubmit="OnValidSubmit">

	<DataAnnotationsValidator />
	<MudGrid>
		<MudItem xs="12" sm="2">
			<MudTextField Label="@Localizer["Unspsc"]"
							@bind-Value="@productDTO.Code"
							@onblur="() => CheckCodeExists(productDTO.Code)"
							For="@(() => productDTO.Code)"
							class="mb-3" />

		</MudItem>
		<MudItem xs="12" sm="5">
			<MudTextField Label="@Localizer["Name"]"
							@bind-Value="@productDTO.Name"
							For="@(() => productDTO.Name)"
							class="mb-3" />

		</MudItem>
		<MudItem xs="12" sm="5">
			<MudTextField Label="@Localizer["Description"]"
							@bind-Value="@productDTO.Description"
							For="@(() => productDTO.Description)"
							class="mb-3" />

		</MudItem>
		<MudItem xs="12">
			<MudAutocomplete T="Lot2DTO"
							 Label=@Localizer["Lot"]
							 Placeholder=@Localizer["SelectALot"]
							 SearchFunc="SearchLot"
							 Value="selectedLot"
							 ValueChanged="LotChanged"
							 ToStringFunc="@(e=> e==null?null : e.Name)"
							 For="@(() => productDTO.Lot)">
				<ItemTemplate Context="itemContext">
					@itemContext.Name
				</ItemTemplate>
			</MudAutocomplete>

		</MudItem>
		<MudItem xs="12">
			<MudAutocomplete T="SegmentDTO"
							 Label=@Localizer["Segment"]
							 Placeholder=@Localizer["SelectASegment"]
							 SearchFunc="SearchSegment"
							 Value="selectedSegment"
							 ValueChanged="SegmentChanged"
							 ToStringFunc="@(e=> e==null || e.Code==0 ?null :$"{e.Code.ToString()} - {e.Name}")">
				<ItemTemplate Context="itemContext">
					@itemContext.Code - @itemContext.Name
				</ItemTemplate>
			</MudAutocomplete>

		</MudItem>
		<MudItem xs="12">
			<MudAutocomplete T="FamilyDTO"
							 Label=@Localizer["Family"]
							 Placeholder=@Localizer["SelectAFamily"]
							 SearchFunc="SearchFamily"
							 Value="selectedFamily"
							 ValueChanged="FamilyChanged"
							 ToStringFunc="@(e=> e==null || e.Code==0 ?null :$"{e.Code.ToString()} - {e.Name}")">
				<ItemTemplate Context="itemContext">
					@itemContext.Code  -  @itemContext.Name
				</ItemTemplate>
			</MudAutocomplete>
		</MudItem>

		<MudItem xs="12">
			<MudAutocomplete T="Classe2DTO"
							 Label=@Localizer["Classe"]
							 Placeholder=@Localizer["SelectAClasse"]
							 SearchFunc="SearchClasse"
							 Value="selectedClasse"
							 ValueChanged="ClasseChanged"
							 ToStringFunc="@(e=> e==null || e.Code==0 ? null :$"{e.Code} - {e.Name}")"
							 For="@(() => productDTO.Classe)">
				<ItemTemplate Context="itemContext">
					@itemContext.Code - @itemContext.Name
				</ItemTemplate>
			</MudAutocomplete>
		</MudItem>
		<MudItem xs="12" sm="4">
			<MudAutocomplete T="UnitMeasurementDTO"
							 Label=@Localizer["UnitMeasurement"]
							 Placeholder=@Localizer["SelectAUnitMeasurement"]
							 SearchFunc="SearchUnitMeasurement"
							 Value="selectedUnitMeasurement"
							 ValueChanged="UnitMeasurementChanged"
							 ToStringFunc="@(e=> e==null?null : $"{e.Name}")"
							 For="@(() => productDTO.UnitMeasurement)">
				<ItemTemplate Context="itemContext">
					@itemContext.Name
				</ItemTemplate>
			</MudAutocomplete>
		</MudItem>
		<MudItem xs="12" sm="4">
			<MudAutocomplete T="CategoryDTO"
							 Label=@Localizer["Category"]
							 Placeholder=@Localizer["SelectACategory"]
							 SearchFunc="SearchCategory"
							 Value="selectedCategory"
							 ValueChanged="CategoryChanged"
							 ToStringFunc="@(e=> e==null?null : $"{e.Name}")"
							 For="@(() => productDTO.Category)">
				<ItemTemplate Context="itemContext">
					@itemContext.Name
				</ItemTemplate>
			</MudAutocomplete>
		</MudItem>
		<MudItem xs="12" sm="4">
			<MudAutocomplete T="StatuDTO"
							 Label=@Localizer["Statu"]
							 Disabled="_disable"
							 Placeholder=@Localizer["SelectAStatu"]
							 SearchFunc="SearchStatu"
							 Value="selectedStatu"
							 ValueChanged="StatuChanged"
							 ToStringFunc="@(e=> e==null?null : $"{e.Name}")"
							 For="@(() => productDTO.Statu)">

				<ItemTemplate Context="itemContext">
					@itemContext.Name
				</ItemTemplate>
			</MudAutocomplete>

		</MudItem>

	</MudGrid>

	<MudDivider Class="my-2" DividerType="DividerType.Inset" />

	<MudButton Variant="Variant.Outlined"
			   StartIcon="@Icons.Material.Filled.ArrowBack"
			   Color="Color.Info"
			   OnClick="ReturnAction">
		@Localizer["Return"]
	</MudButton>

	<MudButton Variant="Variant.Outlined"
			   StartIcon="@Icons.Material.Filled.Check"
			   Color="Color.Primary"
			   ButtonType="ButtonType.Submit">
		@Localizer["SaveChanges"]
	</MudButton>
</EditForm>