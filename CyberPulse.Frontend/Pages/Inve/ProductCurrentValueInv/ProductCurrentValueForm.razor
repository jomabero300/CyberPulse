<NavigationLock OnBeforeInternalNavigation="OnBeforeInternalNavigation" />

<EditForm EditContext="editContext" OnValidSubmit="OnValidSubmit">

	<DataAnnotationsValidator />

	<MudAutocomplete T="ProductDTO"
					 Label=@Localizer["Product"]
					 Placeholder=@Localizer["SelectAProduct"]
					 SearchFunc="SearchProduct"
					 Value="selectedProduct"
					 ValueChanged="ProductChanged"
					 ToStringFunc="@(e=> e==null ?null : $"{e.Name} {e.Description}")">
		<ItemTemplate Context="itemContext">
			@itemContext.Code - @itemContext.Name @itemContext.Description
		</ItemTemplate>
	</MudAutocomplete>

	<MudTextField Label="@Localizer["Worth"]"
					@bind-Value="@ProductCurrentValueDTO.Worth"
					For="@(() => ProductCurrentValueDTO.Worth)"
					class="mb-3" />
	<MudGrid>
		<MudItem xs="12" sm="6">
			<MudTextField Label="@Localizer["PriceLow"]"
						  @bind-Value="@ProductCurrentValueDTO.PriceLow"
						  For="@(() => ProductCurrentValueDTO.PriceLow)"
						  class="mb-3" />
		</MudItem>
		<MudItem xs="12" sm="6">
			<MudTextField Label="@Localizer["PriceHigh"]"
						  @bind-Value="@ProductCurrentValueDTO.PriceHigh"
						  For="@(() => ProductCurrentValueDTO.PriceHigh)"
						  class="mb-3" />
		</MudItem>
	</MudGrid>
	<MudGrid>
		<MudItem xs="12" sm="6">
			<MudAutocomplete T="IvaDTO"
							 Label=@Localizer["Iva"]
							 Placeholder=@Localizer["SelectAIva"]
							 SearchFunc="SearchIva"
							 Value="selectedIva"
							 ValueChanged="IvaChanged"
							 ToStringFunc="@(e=> e==null?null : $"{e.Name}")">
				<ItemTemplate Context="itemContext">
					@itemContext.Name
				</ItemTemplate>
			</MudAutocomplete>

		</MudItem>
		<MudItem xs="12" sm="6">
			<MudTextField Label="@Localizer["Percentage"]"
						  @bind-Value="@ProductCurrentValueDTO.Percentage"
						  For="@(() => ProductCurrentValueDTO.Percentage)"
						  class="mb-3" />

		</MudItem>
	</MudGrid>

	<MudDivider Class="my-2" DividerType="DividerType.Inset" />

	<MudButton Variant="Variant.Outlined"
			   StartIcon="@Icons.Material.Filled.ArrowBack"
			   Color="Color.Info"
			   OnClick="ReturnAction">
		@Localizer["Return"]
	</MudButton>

	<MudButton Variant="Variant.Outlined"
			   StartIcon="@Icons.Material.Filled.Check"
			   Color="Color.Primary"
			   ButtonType="ButtonType.Submit">
		@Localizer["SaveChanges"]
	</MudButton>
</EditForm>